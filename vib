#!/usr/bin/env python3
import sys
from urllib.parse import urljoin as urlj, urlencode as urle
from html.parser import HTMLParser

class ViB(HTMLParser):
	bad = {'script': False, 'style': False}
	form = ['', '', '', {}]
	inputs = ('input', 'textarea', 'select', 'button')

	def handle_starttag(self, tag, attrs):
		attrs = dict(attrs)
		if tag == 'a' and 'href' in attrs.keys():
			sys.stdout.write(f'\033{len(urls)}\035 ')
			urls.append(urlj(urls[1], attrs['href'].strip()))
		elif tag == 'form':
			ViB.form[0] = attrs.get('action', urls[1]).strip()
			ViB.form[1] = attrs.get('method', 'get')
			ViB.form[2] = attrs.get('enctype', 'data')
		elif tag in ViB.inputs and 'name' in attrs.keys() and ViB.form[0]:
			ViB.form[3][attrs['name']] = attrs.get('value', '')
		elif tag in ViB.bad.keys():
			ViB.bad[tag] = True

	def handle_endtag(self, tag):
		if tag in ViB.bad.keys():
			ViB.bad[tag] = False
		elif tag == 'form':
			print(f'\033{len(urls)} {" ".join(ViB.form[0:3])}\035')
			urls.append(f'{urlj(urls[1], ViB.form[0])} {urle(ViB.form[3])}')
			ViB.form = ['', '', '', {}]

	def handle_data(self, data):
		if not (True in ViB.bad.values()) and not data.isspace():
			print(data)

parser = ViB()
sys.stdin.reconfigure(errors='ignore')
input = sys.stdin.readlines()
urls = ["", input[-1]]
parser.feed('\n'.join(input[:-1]))
for i in range(len(urls) - 1, 0, -1):
	print(urls[i])
